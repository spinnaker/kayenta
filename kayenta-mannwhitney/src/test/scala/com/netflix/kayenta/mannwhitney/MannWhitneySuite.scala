/*
 * Copyright 2018 Netflix, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License")
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.netflix.kayenta.mannwhitney

import junit.framework.TestCase.assertEquals
import org.scalatest.FunSuite
import org.apache.commons.math3.distribution.NormalDistribution
import org.apache.commons.math3.analysis.UnivariateFunction

class MannWhitneySuite extends FunSuite {

  private val E = 0.000001

  test("wilcox function") {
    val x = Array(0.033331573009490967, 0.033331431448459625, 0.033340621739625931, 0.033327482640743256, 0.033333081752061844, 0.033337771892547607, 0.033327873796224594, 0.033327061682939529, 0.03333958238363266, 0.033333584666252136, 0.033334124833345413, 0.033332068473100662, 0.033346410840749741, 0.033320359885692596, 0.033335521817207336, 0.033327478915452957, 0.033337440341711044, 0.033335164189338684, 0.033331591635942459, 0.033333487808704376, 0.03333389014005661, 0.033332936465740204, 0.033342763781547546, 0.033325422555208206, 0.033330779522657394, 0.033329371362924576, 0.033336970955133438, 0.033333104103803635, 0.03333364799618721, 0.03333389014005661, 0.03333389014005661, 0.033332463353872299, 0.033333174884319305, 0.033335234969854355, 0.033331751823425293, 0.033333010971546173, 0.033331908285617828, 0.033334992825984955, 0.033332701772451401, 0.033334597945213318, 0.033331673592329025, 0.033334437757730484, 0.03333737701177597, 0.033331122249364853, 0.033332377672195435, 0.03333277627825737, 0.033333729952573776, 0.033333413302898407, 0.033345699310302734, 0.033322576433420181, 0.033331170678138733, 0.033333808183670044, 0.033335316926240921, 0.033331751823425293, 0.033332537859678268, 0.033333729952573776, 0.033332463353872299, 0.033333174884319305, 0.033333335071802139, 0.033334285020828247, 0.033332541584968567, 0.033338405191898346, 0.033329933881759644, 0.033332135528326035, 0.03333277627825737, 0.033333729952573776, 0.033334363251924515, 0.033331591635942459, 0.033333487808704376, 0.033331986516714096, 0.033334042876958847, 0.033334918320178986, 0.033330719918012619, 0.033335227519273758, 0.033331356942653656, 0.033331505954265594, 0.033342603594064713, 0.033325426280498505, 0.03333267942070961, 0.033333968371152878, 0.033332463353872299, 0.033334124833345413, 0.033330641686916351, 0.03333427757024765, 0.033333573490381241, 0.033333808183670044, 0.033338643610477448, 0.033328983932733536, 0.033332452178001404, 0.033336184918880463, 0.033330962061882019, 0.033332377672195435, 0.033332303166389465, 0.03334268182516098, 0.033325903117656708, 0.03333180770277977, 0.033333335071802139, 0.033333335071802139, 0.033329054713249207, 0.033335939049720764, 0.033334847539663315, 0.033333495259284973, 0.033332381397485733, 0.033332698047161102, 0.033333729952573776, 0.03333389014005661, 0.033335790038108826, 0.033330883830785751, 0.033332377672195435, 0.033333253115415573, 0.033332858234643936, 0.033333729952573776, 0.033332936465740204, 0.03333277627825737, 0.033332303166389465, 0.03333364799618721, 0.033334363251924515, 0.033333968371152878, 0.033332936465740204, 0.033333729952573776, 0.033334840089082718, 0.033328346908092499, 0.033335302025079727, 0.033334288746118546, 0.033333413302898407, 0.033332858234643936, 0.03333277627825737, 0.03333277627825737, 0.033334203064441681, 0.033333495259284973, 0.033333335071802139, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.0333409383893013, 0.033326059579849243, 0.033332839608192444, 0.033329691737890244, 0.033334117382764816, 0.033333573490381241, 0.033332858234643936, 0.033339906483888626, 0.03332732617855072, 0.033332604914903641, 0.033332940191030502, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033340461552143097, 0.03332788497209549, 0.033330783247947693, 0.033329766243696213, 0.033332295715808868, 0.03333277627825737, 0.033334203064441681, 0.033333495259284973, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033332858234643936, 0.03333277627825737, 0.033333726227283478, 0.033332463353872299, 0.033334121108055115, 0.033332545310258865, 0.03333364799618721, 0.033332940191030502, 0.033331826329231262, 0.033333566039800644, 0.033334363251924515, 0.033333495259284973, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033332381397485733, 0.033334121108055115, 0.033333495259284973, 0.033332858234643936, 0.033333726227283478, 0.033334840089082718, 0.033331673592329025, 0.033333010971546173, 0.033338084816932678, 0.03333556279540062, 0.033327396959066391, 0.033332288265228271, 0.033332381397485733, 0.033332698047161102, 0.033334203064441681, 0.03333301842212677, 0.033333726227283478, 0.033332940191030502, 0.033332303166389465, 0.03333364799618721, 0.03333389014005661, 0.033333413302898407, 0.033332858234643936, 0.033333253115415573, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.033332940191030502, 0.033333726227283478, 0.033332940191030502, 0.033333253115415573, 0.033333808183670044, 0.03333389014005661, 0.033333413302898407, 0.033332381397485733, 0.03333364799618721, 0.03333389014005661, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.03333570808172226, 0.033331360667943954, 0.033332455903291702, 0.033333253115415573, 0.033333808183670044, 0.033333413302898407, 0.033334285020828247, 0.033332068473100662, 0.0333406962454319, 0.033326543867588043, 0.033331491053104401, 0.033333726227283478, 0.033331990242004395, 0.033333566039800644, 0.033334840089082718, 0.033333573490381241, 0.033330958336591721, 0.033333878964185715, 0.03333301842212677, 0.033335153013467789, 0.033331755548715591, 0.033333010971546173, 0.033333808183670044, 0.033335313200950623, 0.033331755548715591, 0.033331587910652161, 0.033334042876958847, 0.033333495259284973, 0.033331908285617828, 0.033333092927932739, 0.033333808183670044, 0.033333413302898407, 0.033331435173749924, 0.033334437757730484, 0.033334050327539444, 0.033332940191030502, 0.033340856432914734, 0.033325120806694031, 0.033331722021102905, 0.033337607979774475, 0.033331207931041718, 0.033333323895931244, 0.033332940191030502, 0.033334203064441681, 0.033333495259284973, 0.033334285020828247, 0.03333301842212677, 0.03333277627825737, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.03333389014005661, 0.033332940191030502, 0.033332303166389465, 0.033336970955133438, 0.033330176025629044, 0.033333640545606613, 0.033333495259284973, 0.033333808183670044, 0.033333413302898407, 0.033330008387565613, 0.033333245664834976, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033334203064441681, 0.033333495259284973, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033332385122776031, 0.03333364799618721, 0.033332463353872299, 0.033334121108055115, 0.03333301842212677, 0.03333277627825737, 0.033335626125335693, 0.033332310616970062, 0.033332142978906631, 0.03333364799618721, 0.033332463353872299, 0.03333364799618721, 0.033332940191030502, 0.033334203064441681, 0.033332068473100662, 0.033334515988826752, 0.033333100378513336, 0.033333253115415573, 0.033332858234643936, 0.033334203064441681, 0.033333495259284973, 0.033332858234643936, 0.03333277627825737, 0.03333277627825737, 0.033334203064441681, 0.033333495259284973, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.03333389014005661, 0.033338163048028946, 0.03332844004034996, 0.033332839608192444, 0.033333413302898407, 0.033333335071802139, 0.033332385122776031, 0.033332698047161102, 0.033333253115415573, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033332858234643936, 0.033333726227283478, 0.033332463353872299, 0.033334121108055115, 0.033332545310258865, 0.03333364799618721, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033332385122776031, 0.033333171159029007, 0.033333808183670044, 0.033331040292978287, 0.033334828913211823, 0.03333413228392601, 0.033333413302898407, 0.033336181193590164, 0.033331442624330521, 0.033331979066133499, 0.03333364799618721, 0.033333413302898407, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.033332463353872299, 0.03333364799618721, 0.033335790038108826, 0.033331360667943954, 0.033331979066133499, 0.033333171159029007, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.033333413302898407, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033332858234643936, 0.033339425921440125, 0.033327259123325348, 0.033333070576190948, 0.033333495259284973, 0.033331908285617828, 0.033334515988826752, 0.033333577215671539, 0.033332858234643936, 0.033333726227283478, 0.03333389014005661, 0.033333413302898407, 0.033332858234643936, 0.033342275768518448, 0.033325843513011932, 0.033331800252199173, 0.033333335071802139, 0.033333335071802139, 0.033337131142616272, 0.033330179750919342, 0.033332686871290207, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033332858234643936, 0.033332303166389465, 0.033334121108055115, 0.033333968371152878, 0.033332463353872299, 0.033334121108055115, 0.033332545310258865, 0.033333171159029007, 0.033334281295537949, 0.03333301842212677, 0.033337052911520004, 0.033330179750919342, 0.033332686871290207, 0.033332385122776031, 0.033334121108055115, 0.033333495259284973, 0.033332858234643936, 0.033334203064441681, 0.03333301842212677, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033332940191030502, 0.033333726227283478, 0.033332940191030502, 0.03333277627825737, 0.033333253115415573, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333808183670044, 0.033332940191030502, 0.033333726227283478, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033331435173749924, 0.033333010971546173, 0.033329535275697708, 0.033333159983158112, 0.033333413302898407, 0.033332385122776031, 0.033332698047161102, 0.033333253115415573, 0.033333335071802139, 0.03333808109164238, 0.033328920602798462, 0.033332917839288712, 0.033333413302898407, 0.033333808183670044, 0.033332463353872299, 0.03333364799618721, 0.03333389014005661, 0.033332940191030502, 0.033333253115415573, 0.033339031040668488, 0.033328130841255188, 0.033332757651805878, 0.033337213099002838, 0.033329706639051437, 0.033333081752061844, 0.033333413302898407, 0.033333335071802139, 0.033331435173749924, 0.033333010971546173, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033334281295537949, 0.033332545310258865, 0.033329848200082779, 0.033336564898490906, 0.033333979547023773, 0.033333808183670044, 0.033332940191030502, 0.03333277627825737, 0.033333726227283478, 0.033332463353872299, 0.033333644270896912, 0.033333413302898407, 0.033336181193590164, 0.033329073339700699, 0.033333472907543182, 0.033331595361232758, 0.033333484083414078, 0.033334363251924515, 0.033333022147417068, 0.033333253115415573, 0.033332858234643936, 0.033333726227283478, 0.033332940191030502, 0.033333726227283478, 0.03333389014005661, 0.033332940191030502, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033333335071802139, 0.033333808183670044, 0.033332465144098967, 0.033334121108055115, 0.033333495264656968, 0.033332858748650482, 0.033333726953703811, 0.033332940191030502, 0.033332777787036881, 0.033331830054521561, 0.033333090317706336, 0.033332858794946005, 0.033332777787036881, 0.033334203064441681, 0.033333495357252649, 0.033333335071802139, 0.033332858794946005, 0.033333253115415573, 0.033332858804205112, 0.033332777787036881, 0.033332777787036881, 0.033333726805555658, 0.033332940191030502, 0.033333726805555658, 0.033332467079162598, 0.033334121108055115, 0.033332546407406537, 0.033333171227625746, 0.033333808183670044, 0.03333341438098042, 0.033332858831982427, 0.033334203064441681, 0.033333022147417068, 0.033333726805555658, 0.033332467079162598, 0.033333645735534205, 0.03333341438098042, 0.033344251231490589, 0.033324278891086578, 0.033330522477626801, 0.033334121108055115, 0.033332072198390961, 0.033334513638891838, 0.033333101983028871, 0.033332777787036881, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333414390239832, 0.033332858841241535, 0.033332303320019754, 0.03333364565220226, 0.033341009169816971, 0.033336527645587921, 0.033324641098801053, 0.033331319689750671, 0.033332777787036881, 0.033333726731481585, 0.033332940191030502, 0.033332303338537345, 0.033333645596647629, 0.03333341442727749, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033333335071802139, 0.03333285887827795, 0.033333253115415573, 0.033332858887537058, 0.033333253115415573, 0.033333335071802139, 0.033332858896796165, 0.033341795206069946, 0.033326250666029227, 0.033332348047677852, 0.033332940191030502, 0.033333726657407511, 0.033332467079162598, 0.033333645513315691, 0.033332940191030502, 0.033330880273087206, 0.033333402127027512, 0.033332467079162598, 0.0333336453466518, 0.033332940191030502, 0.033333253115415573, 0.033332858970869003, 0.033332777787036881, 0.033333726490740845, 0.033333414529131036, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033332385122776031, 0.033333645263319854, 0.033333414538390456, 0.033333808183670044, 0.033333414529131036, 0.033345197304432403, 0.033322077244520187, 0.033332483243073328, 0.033333577215671539, 0.033332385122776031, 0.033332222259258026, 0.033334121108055115, 0.033332547111110236, 0.033333645207765224, 0.033332940231481367, 0.033334200782976497, 0.033332547111110236, 0.033333645207765224, 0.033333414556909281, 0.033331912010908127, 0.033334039151668549, 0.033333022147417068, 0.033333726416666772, 0.033332940249999887, 0.033333253115415573, 0.033332859026423634, 0.033333726398148252, 0.033333414575428107, 0.033333335071802139, 0.033332859026423634, 0.033333253115415573, 0.033332859035682734, 0.033333726379629738, 0.03333389014005661, 0.033332940268518407, 0.033333253115415573, 0.033332385122776031, 0.033333645096655963, 0.033332940305555447, 0.033333726361111218, 0.033334363251924515, 0.033332549035549164, 0.033333645124433285, 0.033333414584687519, 0.033332859035682734, 0.033332777787036881, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033332940305555447, 0.033332777787036881, 0.033333253115415573, 0.033332859063460049, 0.033332777787036881, 0.033334200588528817, 0.033341560901615219, 0.033325701951980591, 0.033332739025354385, 0.033333970179990124, 0.033331044018268585, 0.033332452560300749, 0.033333253115415573, 0.033333335071802139, 0.033332859109755579, 0.033333726231481585, 0.033332940435185074, 0.033333253115415573, 0.033336654305458069, 0.033330108970403671, 0.033332683145999908, 0.033333335071802139, 0.033333808183670044, 0.033332940453703594, 0.033333253115415573, 0.033333808183670044, 0.03333389014005661, 0.033332467079162598, 0.033332698047161102, 0.033334200421859368, 0.033333496005422403, 0.033332859119014686, 0.033327562574424409, 0.033332830194092361, 0.03333389014005661, 0.033332940657407301, 0.033333726227283478, 0.033332466560742027, 0.033333170431355995, 0.033333807443087012, 0.033333414779135206, 0.033331437015310092, 0.033334429722471248, 0.033333577706663113, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.03334234412193491, 0.03332539570553001, 0.033331704616979527, 0.033333333333333333, 0.033333807433827599, 0.033330096462569674, 0.033332288741132837, 0.033335148044441272, 0.033332237194690327, 0.03333308879000494, 0.033332859304196778, 0.033333725842592699, 0.03333294082407396, 0.033333725842592699, 0.033333414853210515, 0.033338548696890728, 0.033329488482097963, 0.033332518376566866, 0.033332385272342772, 0.033333170283212782, 0.033341394089436455, 0.033327606021646888, 0.033331636961632112, 0.033333251816173429, 0.033333333333333333, 0.033333333333333333, 0.033333807378271116, 0.03333294080555544, 0.033333251816173429, 0.033333333333333333, 0.033333333333333333, 0.033332385290860675, 0.033333644291113837, 0.03333294084259248, 0.033334199866294552, 0.033342031603039952, 0.033325791087950536, 0.033331784795925731, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033339022804560907, 0.033341424390571209, 0.033321279221429051, 0.033331051361216613, 0.033333333333333326, 0.033332859322714986, 0.033333725805555658, 0.03333341487172934, 0.033333333333333326, 0.03333380735975229, 0.03333294084259248, 0.033333251797655221, 0.033332859322714986, 0.033333725805555658, 0.033331518924051777, 0.033334903111118086, 0.033333185492607796, 0.033333725805555658, 0.033332940861111, 0.033333725805555658, 0.033332466866292487, 0.033332696235558942, 0.033334199782959831, 0.033332074474682581, 0.033333088623346607, 0.033333333333333333, 0.033332859359751409, 0.033334673739125756, 0.033332630043832891, 0.033333644180004576, 0.033332940916666554, 0.033333725750000105, 0.033332940916666554, 0.033333725750000105, 0.033342423576329321, 0.033324926195972791, 0.033332094662882922, 0.033333414908766998, 0.033332385401968083, 0.033333170153587471, 0.033332859378269616, 0.033333725694444545, 0.033333888898148298, 0.033332467005179063, 0.033339332868476623, 0.033328705070809879, 0.033332828388867759, 0.033332940953703594, 0.033332777787036881, 0.033333725694444545, 0.033333414927285823, 0.033333333333333333, 0.033333807304195807, 0.033332940953703594, 0.033333725712963072, 0.033333414918026411, 0.033332859369010509, 0.033332303847771146, 0.033333644068895316, 0.033333888898148298, 0.033333414927285823, 0.033333333333333333, 0.033333807304195807, 0.033332467005179063, 0.033333644096672631, 0.033333414927285823, 0.033333333333333333, 0.033332859378269616, 0.03333325173284149, 0.033333333333333333, 0.033332859387528724, 0.033329460673500177, 0.033332679938971099, 0.033333333333333333, 0.033332385624182899, 0.033333643791122171, 0.033336732443948879, 0.033331535375235768, 0.0333329249877325, 0.033332859461601562, 0.033332777787036881, 0.033333251640250437, 0.033333333333333333)
    val y = Array(0.033332832157611847, 0.033334780484437943, 0.033332996070384979, 0.033332277089357376, 0.033333722501993179, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.03333389014005661, 0.033332888036966324, 0.033333279192447662, 0.033331830054521561, 0.033333670347929001, 0.03333389014005661, 0.033333387225866318, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.03333238884806633, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033333387225866318, 0.033328328281641006, 0.033332783728837967, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.03333277627825737, 0.033333778381347656, 0.03333389014005661, 0.03333238884806633, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033332277089357376, 0.033333722501993179, 0.033333387225866318, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033331833779811859, 0.033333167433738708, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033334333449602127, 0.033332444727420807, 0.033332221210002899, 0.033333722501993179, 0.033333387225866318, 0.033332832157611847, 0.033333778381347656, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033333387225866318, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033331330865621567, 0.033333111554384232, 0.033333834260702133, 0.033332888036966324, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.03333277627825737, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033329330384731293, 0.03333389014005661, 0.033332444727420807, 0.033332724124193192, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334724605083466, 0.033332999795675278, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033331833779811859, 0.033334165811538696, 0.033333443105220795, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.03333238884806633, 0.033334221690893173, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033331334590911865, 0.033333610743284225, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334221690893173, 0.033332943916320801, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.03333389014005661, 0.03333238884806633, 0.033333223313093185, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334720879793167, 0.033333998173475266, 0.03333238884806633, 0.033332724124193192, 0.033333279192447662, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333778381347656, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333834260702133, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033332724124193192, 0.033333279192447662, 0.033331833779811859, 0.033335167914628983, 0.033333055675029755, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333722501993179, 0.033332888036966324, 0.033333778381347656, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033331833779811859, 0.033333167433738708, 0.033333335071802139, 0.033333335071802139, 0.033331833779811859, 0.033333167433738708, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033334333449602127, 0.033331945538520813, 0.033333666622638702, 0.03333389014005661, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334221690893173, 0.033332943916320801, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.03333277627825737, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.03333277627825737, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.03333277627825737, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033332832157611847, 0.03333277627825737, 0.033333279192447662, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033331390470266342, 0.033333111554384232, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033330835402011871, 0.033334553241729736, 0.033333498984575272, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333722501993179, 0.033333390951156616, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033331278711557388, 0.033333111554384232, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889490740619, 0.033333279192447662, 0.033332833647216988, 0.033333778381347656, 0.033333390951156616, 0.033333335071802139, 0.033333335071802139, 0.033332833647216988, 0.033333778381347656, 0.033332889509259132, 0.033333279192447662, 0.033333335071802139, 0.033332833656476095, 0.033333279192447662, 0.033333834260702133, 0.033333390951156616, 0.033332833656476095, 0.033333778381347656, 0.033332889527777652, 0.033332777787036881, 0.033333279192447662, 0.033333335071802139, 0.033329837024211884, 0.033332442109572306, 0.03333427757024765, 0.03333244603703605, 0.033333722501993179, 0.033333390951156616, 0.03333283373980804, 0.033333279192447662, 0.033333335071802139, 0.033332833749067141, 0.033332777787036881, 0.033333279192447662, 0.033333834260702133, 0.03333389014005661, 0.033332390145348903, 0.033333221374102343, 0.033333335071802139, 0.033333834260702133, 0.033332889731481352, 0.033333778381347656, 0.033332889731481352, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332833767585356, 0.033333778381347656, 0.033332889749999872, 0.033333778381347656, 0.033333390951156616, 0.033332833767585356, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333778381347656, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333778381347656, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033333390951156616, 0.033332833767585356, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033332833776844456, 0.033332777787036881, 0.033332777787036881, 0.033333277315748443, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332833804621771, 0.033333778381347656, 0.033332889824073945, 0.033333277306489335, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889824073945, 0.033333277306489335, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332833813880879, 0.033333277297230235, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889842592466, 0.033333277297230235, 0.033333335071802139, 0.033328339457511902, 0.033332273364067078, 0.033333277195380082, 0.033333834260702133, 0.033332891762256622, 0.033333277195380082, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332891762256622, 0.033333778381347656, 0.033332891762256622, 0.033333277195380082, 0.033333834260702133, 0.033332891762256622, 0.033333778381347656, 0.033332891762256622, 0.033328783119491459, 0.033332329243421555, 0.033332278487928045, 0.033333220837083212, 0.033333834260702133, 0.033332891762256622, 0.033333776398148267, 0.033332890268518392, 0.033332777787036881, 0.033332777787036881, 0.033333277065752606, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033332834054617608, 0.033333277056493506, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334, 0.033332834063876715, 0.033333277047234398, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832610173128, 0.033332890342592472, 0.033333277047234398, 0.033332834073135816, 0.033332777787036881, 0.033333277028716184, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832591654296, 0.033332890379629498, 0.033332777787036881, 0.033333277019457083, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832582394883, 0.033331891964711084, 0.033333663572325638, 0.033333389658346153, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033332834110172231, 0.033330781097819687, 0.03333305145867474, 0.033333333333333333, 0.033333832517578994, 0.033332890527777652, 0.033333276954643346, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832517578994, 0.033332890527777652, 0.033333276954643346, 0.033332834165726868, 0.033333276945384238, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033332834174985969, 0.033333276936125138, 0.033333832499060162, 0.033332890564814692, 0.033333776101851967, 0.033333389723162049, 0.033332834174985969, 0.033333276936125138, 0.033333832499060162, 0.033332890564814692, 0.033333276936125138, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832499060162, 0.033332890564814692, 0.033333276936125138, 0.033333333333333333, 0.033333832499060162, 0.033333389723162049, 0.033333333333333333, 0.033333333333333333, 0.033332834174985969, 0.033333776101851967, 0.033332890564814692, 0.033333276936125138, 0.033333333333333333, 0.033333832499060162, 0.033332890564814692, 0.033333276936125138, 0.033332834184245076, 0.033333776083333454, 0.033332890583333205, 0.03333327692686603, 0.033333333333333333, 0.033333832489800749, 0.033332890583333205, 0.03333327692686603, 0.033333333333333333, 0.033333333333333333, 0.033333832489800749, 0.033332890583333205, 0.03333327692686603, 0.033332834193504184, 0.033333776064814934, 0.033332890601851725, 0.033333276917606923, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832480541337, 0.033332890601851725, 0.033333276917606923, 0.033332834202763284)
    val xLen = x.length.toDouble
    val yLen = y.length.toDouble

    assertEquals(-1.229416, MannWhitney.wilcoxonDiff(0, 0, x, y), E)
    assertEquals(-35.80606, MannWhitney.wilcoxonDiff(5, 0, x, y), E)
  }

  test("returns expected values") {
    val params = MannWhitneyParams(mu = 0.0, confidenceLevel = 0.95, controlData = Array(1.0, 2.0, 3.0, 4.0), experimentData = Array(10.0, 20.0, 30.0, 40.0))
    val mw = new MannWhitney
    val result = mw.eval(params)
    assertEquals(6.0, result.confidenceInterval.head, E)
    assertEquals(39.0, result.confidenceInterval.last, E)
    assertEquals(22.5, result.estimate, E)
  }

  test("quant") {
    val zQuant = new NormalDistribution(0,1).inverseCumulativeProbability(0.02/2)
    assertEquals(-2.326348, zQuant, E)
  }

  test("test problem case") {
    val experiment = Array(0.033331573009490967, 0.033331431448459625, 0.033340621739625931, 0.033327482640743256, 0.033333081752061844, 0.033337771892547607, 0.033327873796224594, 0.033327061682939529, 0.03333958238363266, 0.033333584666252136, 0.033334124833345413, 0.033332068473100662, 0.033346410840749741, 0.033320359885692596, 0.033335521817207336, 0.033327478915452957, 0.033337440341711044, 0.033335164189338684, 0.033331591635942459, 0.033333487808704376, 0.03333389014005661, 0.033332936465740204, 0.033342763781547546, 0.033325422555208206, 0.033330779522657394, 0.033329371362924576, 0.033336970955133438, 0.033333104103803635, 0.03333364799618721, 0.03333389014005661, 0.03333389014005661, 0.033332463353872299, 0.033333174884319305, 0.033335234969854355, 0.033331751823425293, 0.033333010971546173, 0.033331908285617828, 0.033334992825984955, 0.033332701772451401, 0.033334597945213318, 0.033331673592329025, 0.033334437757730484, 0.03333737701177597, 0.033331122249364853, 0.033332377672195435, 0.03333277627825737, 0.033333729952573776, 0.033333413302898407, 0.033345699310302734, 0.033322576433420181, 0.033331170678138733, 0.033333808183670044, 0.033335316926240921, 0.033331751823425293, 0.033332537859678268, 0.033333729952573776, 0.033332463353872299, 0.033333174884319305, 0.033333335071802139, 0.033334285020828247, 0.033332541584968567, 0.033338405191898346, 0.033329933881759644, 0.033332135528326035, 0.03333277627825737, 0.033333729952573776, 0.033334363251924515, 0.033331591635942459, 0.033333487808704376, 0.033331986516714096, 0.033334042876958847, 0.033334918320178986, 0.033330719918012619, 0.033335227519273758, 0.033331356942653656, 0.033331505954265594, 0.033342603594064713, 0.033325426280498505, 0.03333267942070961, 0.033333968371152878, 0.033332463353872299, 0.033334124833345413, 0.033330641686916351, 0.03333427757024765, 0.033333573490381241, 0.033333808183670044, 0.033338643610477448, 0.033328983932733536, 0.033332452178001404, 0.033336184918880463, 0.033330962061882019, 0.033332377672195435, 0.033332303166389465, 0.03334268182516098, 0.033325903117656708, 0.03333180770277977, 0.033333335071802139, 0.033333335071802139, 0.033329054713249207, 0.033335939049720764, 0.033334847539663315, 0.033333495259284973, 0.033332381397485733, 0.033332698047161102, 0.033333729952573776, 0.03333389014005661, 0.033335790038108826, 0.033330883830785751, 0.033332377672195435, 0.033333253115415573, 0.033332858234643936, 0.033333729952573776, 0.033332936465740204, 0.03333277627825737, 0.033332303166389465, 0.03333364799618721, 0.033334363251924515, 0.033333968371152878, 0.033332936465740204, 0.033333729952573776, 0.033334840089082718, 0.033328346908092499, 0.033335302025079727, 0.033334288746118546, 0.033333413302898407, 0.033332858234643936, 0.03333277627825737, 0.03333277627825737, 0.033334203064441681, 0.033333495259284973, 0.033333335071802139, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.0333409383893013, 0.033326059579849243, 0.033332839608192444, 0.033329691737890244, 0.033334117382764816, 0.033333573490381241, 0.033332858234643936, 0.033339906483888626, 0.03332732617855072, 0.033332604914903641, 0.033332940191030502, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033340461552143097, 0.03332788497209549, 0.033330783247947693, 0.033329766243696213, 0.033332295715808868, 0.03333277627825737, 0.033334203064441681, 0.033333495259284973, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033332858234643936, 0.03333277627825737, 0.033333726227283478, 0.033332463353872299, 0.033334121108055115, 0.033332545310258865, 0.03333364799618721, 0.033332940191030502, 0.033331826329231262, 0.033333566039800644, 0.033334363251924515, 0.033333495259284973, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033332381397485733, 0.033334121108055115, 0.033333495259284973, 0.033332858234643936, 0.033333726227283478, 0.033334840089082718, 0.033331673592329025, 0.033333010971546173, 0.033338084816932678, 0.03333556279540062, 0.033327396959066391, 0.033332288265228271, 0.033332381397485733, 0.033332698047161102, 0.033334203064441681, 0.03333301842212677, 0.033333726227283478, 0.033332940191030502, 0.033332303166389465, 0.03333364799618721, 0.03333389014005661, 0.033333413302898407, 0.033332858234643936, 0.033333253115415573, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.033332940191030502, 0.033333726227283478, 0.033332940191030502, 0.033333253115415573, 0.033333808183670044, 0.03333389014005661, 0.033333413302898407, 0.033332381397485733, 0.03333364799618721, 0.03333389014005661, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.03333570808172226, 0.033331360667943954, 0.033332455903291702, 0.033333253115415573, 0.033333808183670044, 0.033333413302898407, 0.033334285020828247, 0.033332068473100662, 0.0333406962454319, 0.033326543867588043, 0.033331491053104401, 0.033333726227283478, 0.033331990242004395, 0.033333566039800644, 0.033334840089082718, 0.033333573490381241, 0.033330958336591721, 0.033333878964185715, 0.03333301842212677, 0.033335153013467789, 0.033331755548715591, 0.033333010971546173, 0.033333808183670044, 0.033335313200950623, 0.033331755548715591, 0.033331587910652161, 0.033334042876958847, 0.033333495259284973, 0.033331908285617828, 0.033333092927932739, 0.033333808183670044, 0.033333413302898407, 0.033331435173749924, 0.033334437757730484, 0.033334050327539444, 0.033332940191030502, 0.033340856432914734, 0.033325120806694031, 0.033331722021102905, 0.033337607979774475, 0.033331207931041718, 0.033333323895931244, 0.033332940191030502, 0.033334203064441681, 0.033333495259284973, 0.033334285020828247, 0.03333301842212677, 0.03333277627825737, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.03333389014005661, 0.033332940191030502, 0.033332303166389465, 0.033336970955133438, 0.033330176025629044, 0.033333640545606613, 0.033333495259284973, 0.033333808183670044, 0.033333413302898407, 0.033330008387565613, 0.033333245664834976, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033334203064441681, 0.033333495259284973, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033332385122776031, 0.03333364799618721, 0.033332463353872299, 0.033334121108055115, 0.03333301842212677, 0.03333277627825737, 0.033335626125335693, 0.033332310616970062, 0.033332142978906631, 0.03333364799618721, 0.033332463353872299, 0.03333364799618721, 0.033332940191030502, 0.033334203064441681, 0.033332068473100662, 0.033334515988826752, 0.033333100378513336, 0.033333253115415573, 0.033332858234643936, 0.033334203064441681, 0.033333495259284973, 0.033332858234643936, 0.03333277627825737, 0.03333277627825737, 0.033334203064441681, 0.033333495259284973, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.03333389014005661, 0.033338163048028946, 0.03332844004034996, 0.033332839608192444, 0.033333413302898407, 0.033333335071802139, 0.033332385122776031, 0.033332698047161102, 0.033333253115415573, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033332858234643936, 0.033333726227283478, 0.033332463353872299, 0.033334121108055115, 0.033332545310258865, 0.03333364799618721, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033332385122776031, 0.033333171159029007, 0.033333808183670044, 0.033331040292978287, 0.033334828913211823, 0.03333413228392601, 0.033333413302898407, 0.033336181193590164, 0.033331442624330521, 0.033331979066133499, 0.03333364799618721, 0.033333413302898407, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.033332463353872299, 0.03333364799618721, 0.033335790038108826, 0.033331360667943954, 0.033331979066133499, 0.033333171159029007, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033333808183670044, 0.033333413302898407, 0.033332858234643936, 0.033333726227283478, 0.033333413302898407, 0.033332858234643936, 0.033339425921440125, 0.033327259123325348, 0.033333070576190948, 0.033333495259284973, 0.033331908285617828, 0.033334515988826752, 0.033333577215671539, 0.033332858234643936, 0.033333726227283478, 0.03333389014005661, 0.033333413302898407, 0.033332858234643936, 0.033342275768518448, 0.033325843513011932, 0.033331800252199173, 0.033333335071802139, 0.033333335071802139, 0.033337131142616272, 0.033330179750919342, 0.033332686871290207, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033332858234643936, 0.033332303166389465, 0.033334121108055115, 0.033333968371152878, 0.033332463353872299, 0.033334121108055115, 0.033332545310258865, 0.033333171159029007, 0.033334281295537949, 0.03333301842212677, 0.033337052911520004, 0.033330179750919342, 0.033332686871290207, 0.033332385122776031, 0.033334121108055115, 0.033333495259284973, 0.033332858234643936, 0.033334203064441681, 0.03333301842212677, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332858234643936, 0.033333726227283478, 0.033332940191030502, 0.033333726227283478, 0.033332940191030502, 0.03333277627825737, 0.033333253115415573, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333808183670044, 0.033332940191030502, 0.033333726227283478, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033331435173749924, 0.033333010971546173, 0.033329535275697708, 0.033333159983158112, 0.033333413302898407, 0.033332385122776031, 0.033332698047161102, 0.033333253115415573, 0.033333335071802139, 0.03333808109164238, 0.033328920602798462, 0.033332917839288712, 0.033333413302898407, 0.033333808183670044, 0.033332463353872299, 0.03333364799618721, 0.03333389014005661, 0.033332940191030502, 0.033333253115415573, 0.033339031040668488, 0.033328130841255188, 0.033332757651805878, 0.033337213099002838, 0.033329706639051437, 0.033333081752061844, 0.033333413302898407, 0.033333335071802139, 0.033331435173749924, 0.033333010971546173, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033332858234643936, 0.033333253115415573, 0.033334281295537949, 0.033332545310258865, 0.033329848200082779, 0.033336564898490906, 0.033333979547023773, 0.033333808183670044, 0.033332940191030502, 0.03333277627825737, 0.033333726227283478, 0.033332463353872299, 0.033333644270896912, 0.033333413302898407, 0.033336181193590164, 0.033329073339700699, 0.033333472907543182, 0.033331595361232758, 0.033333484083414078, 0.033334363251924515, 0.033333022147417068, 0.033333253115415573, 0.033332858234643936, 0.033333726227283478, 0.033332940191030502, 0.033333726227283478, 0.03333389014005661, 0.033332940191030502, 0.03333277627825737, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333413302898407, 0.033332858234643936, 0.033333253115415573, 0.033333335071802139, 0.033333335071802139, 0.033333808183670044, 0.033332465144098967, 0.033334121108055115, 0.033333495264656968, 0.033332858748650482, 0.033333726953703811, 0.033332940191030502, 0.033332777787036881, 0.033331830054521561, 0.033333090317706336, 0.033332858794946005, 0.033332777787036881, 0.033334203064441681, 0.033333495357252649, 0.033333335071802139, 0.033332858794946005, 0.033333253115415573, 0.033332858804205112, 0.033332777787036881, 0.033332777787036881, 0.033333726805555658, 0.033332940191030502, 0.033333726805555658, 0.033332467079162598, 0.033334121108055115, 0.033332546407406537, 0.033333171227625746, 0.033333808183670044, 0.03333341438098042, 0.033332858831982427, 0.033334203064441681, 0.033333022147417068, 0.033333726805555658, 0.033332467079162598, 0.033333645735534205, 0.03333341438098042, 0.033344251231490589, 0.033324278891086578, 0.033330522477626801, 0.033334121108055115, 0.033332072198390961, 0.033334513638891838, 0.033333101983028871, 0.033332777787036881, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033333414390239832, 0.033332858841241535, 0.033332303320019754, 0.03333364565220226, 0.033341009169816971, 0.033336527645587921, 0.033324641098801053, 0.033331319689750671, 0.033332777787036881, 0.033333726731481585, 0.033332940191030502, 0.033332303338537345, 0.033333645596647629, 0.03333341442727749, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033333335071802139, 0.03333285887827795, 0.033333253115415573, 0.033332858887537058, 0.033333253115415573, 0.033333335071802139, 0.033332858896796165, 0.033341795206069946, 0.033326250666029227, 0.033332348047677852, 0.033332940191030502, 0.033333726657407511, 0.033332467079162598, 0.033333645513315691, 0.033332940191030502, 0.033330880273087206, 0.033333402127027512, 0.033332467079162598, 0.0333336453466518, 0.033332940191030502, 0.033333253115415573, 0.033332858970869003, 0.033332777787036881, 0.033333726490740845, 0.033333414529131036, 0.033333808183670044, 0.033332940191030502, 0.033333253115415573, 0.033333335071802139, 0.033332385122776031, 0.033333645263319854, 0.033333414538390456, 0.033333808183670044, 0.033333414529131036, 0.033345197304432403, 0.033322077244520187, 0.033332483243073328, 0.033333577215671539, 0.033332385122776031, 0.033332222259258026, 0.033334121108055115, 0.033332547111110236, 0.033333645207765224, 0.033332940231481367, 0.033334200782976497, 0.033332547111110236, 0.033333645207765224, 0.033333414556909281, 0.033331912010908127, 0.033334039151668549, 0.033333022147417068, 0.033333726416666772, 0.033332940249999887, 0.033333253115415573, 0.033332859026423634, 0.033333726398148252, 0.033333414575428107, 0.033333335071802139, 0.033332859026423634, 0.033333253115415573, 0.033332859035682734, 0.033333726379629738, 0.03333389014005661, 0.033332940268518407, 0.033333253115415573, 0.033332385122776031, 0.033333645096655963, 0.033332940305555447, 0.033333726361111218, 0.033334363251924515, 0.033332549035549164, 0.033333645124433285, 0.033333414584687519, 0.033332859035682734, 0.033332777787036881, 0.033333253115415573, 0.033333335071802139, 0.033333808183670044, 0.033332940305555447, 0.033332777787036881, 0.033333253115415573, 0.033332859063460049, 0.033332777787036881, 0.033334200588528817, 0.033341560901615219, 0.033325701951980591, 0.033332739025354385, 0.033333970179990124, 0.033331044018268585, 0.033332452560300749, 0.033333253115415573, 0.033333335071802139, 0.033332859109755579, 0.033333726231481585, 0.033332940435185074, 0.033333253115415573, 0.033336654305458069, 0.033330108970403671, 0.033332683145999908, 0.033333335071802139, 0.033333808183670044, 0.033332940453703594, 0.033333253115415573, 0.033333808183670044, 0.03333389014005661, 0.033332467079162598, 0.033332698047161102, 0.033334200421859368, 0.033333496005422403, 0.033332859119014686, 0.033327562574424409, 0.033332830194092361, 0.03333389014005661, 0.033332940657407301, 0.033333726227283478, 0.033332466560742027, 0.033333170431355995, 0.033333807443087012, 0.033333414779135206, 0.033331437015310092, 0.033334429722471248, 0.033333577706663113, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.03334234412193491, 0.03332539570553001, 0.033331704616979527, 0.033333333333333333, 0.033333807433827599, 0.033330096462569674, 0.033332288741132837, 0.033335148044441272, 0.033332237194690327, 0.03333308879000494, 0.033332859304196778, 0.033333725842592699, 0.03333294082407396, 0.033333725842592699, 0.033333414853210515, 0.033338548696890728, 0.033329488482097963, 0.033332518376566866, 0.033332385272342772, 0.033333170283212782, 0.033341394089436455, 0.033327606021646888, 0.033331636961632112, 0.033333251816173429, 0.033333333333333333, 0.033333333333333333, 0.033333807378271116, 0.03333294080555544, 0.033333251816173429, 0.033333333333333333, 0.033333333333333333, 0.033332385290860675, 0.033333644291113837, 0.03333294084259248, 0.033334199866294552, 0.033342031603039952, 0.033325791087950536, 0.033331784795925731, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033339022804560907, 0.033341424390571209, 0.033321279221429051, 0.033331051361216613, 0.033333333333333326, 0.033332859322714986, 0.033333725805555658, 0.03333341487172934, 0.033333333333333326, 0.03333380735975229, 0.03333294084259248, 0.033333251797655221, 0.033332859322714986, 0.033333725805555658, 0.033331518924051777, 0.033334903111118086, 0.033333185492607796, 0.033333725805555658, 0.033332940861111, 0.033333725805555658, 0.033332466866292487, 0.033332696235558942, 0.033334199782959831, 0.033332074474682581, 0.033333088623346607, 0.033333333333333333, 0.033332859359751409, 0.033334673739125756, 0.033332630043832891, 0.033333644180004576, 0.033332940916666554, 0.033333725750000105, 0.033332940916666554, 0.033333725750000105, 0.033342423576329321, 0.033324926195972791, 0.033332094662882922, 0.033333414908766998, 0.033332385401968083, 0.033333170153587471, 0.033332859378269616, 0.033333725694444545, 0.033333888898148298, 0.033332467005179063, 0.033339332868476623, 0.033328705070809879, 0.033332828388867759, 0.033332940953703594, 0.033332777787036881, 0.033333725694444545, 0.033333414927285823, 0.033333333333333333, 0.033333807304195807, 0.033332940953703594, 0.033333725712963072, 0.033333414918026411, 0.033332859369010509, 0.033332303847771146, 0.033333644068895316, 0.033333888898148298, 0.033333414927285823, 0.033333333333333333, 0.033333807304195807, 0.033332467005179063, 0.033333644096672631, 0.033333414927285823, 0.033333333333333333, 0.033332859378269616, 0.03333325173284149, 0.033333333333333333, 0.033332859387528724, 0.033329460673500177, 0.033332679938971099, 0.033333333333333333, 0.033332385624182899, 0.033333643791122171, 0.033336732443948879, 0.033331535375235768, 0.0333329249877325, 0.033332859461601562, 0.033332777787036881, 0.033333251640250437, 0.033333333333333333)
    val control = Array(0.033332832157611847, 0.033334780484437943, 0.033332996070384979, 0.033332277089357376, 0.033333722501993179, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.03333389014005661, 0.033332888036966324, 0.033333279192447662, 0.033331830054521561, 0.033333670347929001, 0.03333389014005661, 0.033333387225866318, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.03333238884806633, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033333387225866318, 0.033328328281641006, 0.033332783728837967, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.03333277627825737, 0.033333778381347656, 0.03333389014005661, 0.03333238884806633, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033332277089357376, 0.033333722501993179, 0.033333387225866318, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033331833779811859, 0.033333167433738708, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033334333449602127, 0.033332444727420807, 0.033332221210002899, 0.033333722501993179, 0.033333387225866318, 0.033332832157611847, 0.033333778381347656, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033333387225866318, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033331330865621567, 0.033333111554384232, 0.033333834260702133, 0.033332888036966324, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.03333277627825737, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033329330384731293, 0.03333389014005661, 0.033332444727420807, 0.033332724124193192, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334724605083466, 0.033332999795675278, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033331833779811859, 0.033334165811538696, 0.033333443105220795, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.03333238884806633, 0.033334221690893173, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033331334590911865, 0.033333610743284225, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334221690893173, 0.033332943916320801, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.03333389014005661, 0.03333238884806633, 0.033333223313093185, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334720879793167, 0.033333998173475266, 0.03333238884806633, 0.033332724124193192, 0.033333279192447662, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333778381347656, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333834260702133, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033332724124193192, 0.033333279192447662, 0.033331833779811859, 0.033335167914628983, 0.033333055675029755, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333722501993179, 0.033332888036966324, 0.033333778381347656, 0.033333387225866318, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033331833779811859, 0.033333167433738708, 0.033333335071802139, 0.033333335071802139, 0.033331833779811859, 0.033333167433738708, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033334333449602127, 0.033331945538520813, 0.033333666622638702, 0.03333389014005661, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033334221690893173, 0.033332943916320801, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.03333277627825737, 0.033333778381347656, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332332968711853, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033332832157611847, 0.033333778381347656, 0.033332888036966324, 0.03333277627825737, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.03333277627825737, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033332832157611847, 0.03333277627825737, 0.033333279192447662, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033331390470266342, 0.033333111554384232, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033330835402011871, 0.033334553241729736, 0.033333498984575272, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333223313093185, 0.033333335071802139, 0.033333335071802139, 0.033334333449602127, 0.033332444727420807, 0.033333722501993179, 0.033333390951156616, 0.033332832157611847, 0.033333279192447662, 0.033333834260702133, 0.033332888036966324, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332832157611847, 0.033331278711557388, 0.033333111554384232, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889490740619, 0.033333279192447662, 0.033332833647216988, 0.033333778381347656, 0.033333390951156616, 0.033333335071802139, 0.033333335071802139, 0.033332833647216988, 0.033333778381347656, 0.033332889509259132, 0.033333279192447662, 0.033333335071802139, 0.033332833656476095, 0.033333279192447662, 0.033333834260702133, 0.033333390951156616, 0.033332833656476095, 0.033333778381347656, 0.033332889527777652, 0.033332777787036881, 0.033333279192447662, 0.033333335071802139, 0.033329837024211884, 0.033332442109572306, 0.03333427757024765, 0.03333244603703605, 0.033333722501993179, 0.033333390951156616, 0.03333283373980804, 0.033333279192447662, 0.033333335071802139, 0.033332833749067141, 0.033332777787036881, 0.033333279192447662, 0.033333834260702133, 0.03333389014005661, 0.033332390145348903, 0.033333221374102343, 0.033333335071802139, 0.033333834260702133, 0.033332889731481352, 0.033333778381347656, 0.033332889731481352, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332833767585356, 0.033333778381347656, 0.033332889749999872, 0.033333778381347656, 0.033333390951156616, 0.033332833767585356, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333778381347656, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333778381347656, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033333390951156616, 0.033332833767585356, 0.033333279192447662, 0.033333335071802139, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333834260702133, 0.033332889749999872, 0.033333279192447662, 0.033333335071802139, 0.033332833776844456, 0.033332777787036881, 0.033332777787036881, 0.033333277315748443, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332833804621771, 0.033333778381347656, 0.033332889824073945, 0.033333277306489335, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889824073945, 0.033333277306489335, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033332833813880879, 0.033333277297230235, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332889842592466, 0.033333277297230235, 0.033333335071802139, 0.033328339457511902, 0.033332273364067078, 0.033333277195380082, 0.033333834260702133, 0.033332891762256622, 0.033333277195380082, 0.033333335071802139, 0.033333335071802139, 0.033333834260702133, 0.033332891762256622, 0.033333778381347656, 0.033332891762256622, 0.033333277195380082, 0.033333834260702133, 0.033332891762256622, 0.033333778381347656, 0.033332891762256622, 0.033328783119491459, 0.033332329243421555, 0.033332278487928045, 0.033333220837083212, 0.033333834260702133, 0.033332891762256622, 0.033333776398148267, 0.033332890268518392, 0.033332777787036881, 0.033332777787036881, 0.033333277065752606, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033332834054617608, 0.033333277056493506, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334, 0.033332834063876715, 0.033333277047234398, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832610173128, 0.033332890342592472, 0.033333277047234398, 0.033332834073135816, 0.033332777787036881, 0.033333277028716184, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832591654296, 0.033332890379629498, 0.033332777787036881, 0.033333277019457083, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832582394883, 0.033331891964711084, 0.033333663572325638, 0.033333389658346153, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033332834110172231, 0.033330781097819687, 0.03333305145867474, 0.033333333333333333, 0.033333832517578994, 0.033332890527777652, 0.033333276954643346, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832517578994, 0.033332890527777652, 0.033333276954643346, 0.033332834165726868, 0.033333276945384238, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033332834174985969, 0.033333276936125138, 0.033333832499060162, 0.033332890564814692, 0.033333776101851967, 0.033333389723162049, 0.033332834174985969, 0.033333276936125138, 0.033333832499060162, 0.033332890564814692, 0.033333276936125138, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832499060162, 0.033332890564814692, 0.033333276936125138, 0.033333333333333333, 0.033333832499060162, 0.033333389723162049, 0.033333333333333333, 0.033333333333333333, 0.033332834174985969, 0.033333776101851967, 0.033332890564814692, 0.033333276936125138, 0.033333333333333333, 0.033333832499060162, 0.033332890564814692, 0.033333276936125138, 0.033332834184245076, 0.033333776083333454, 0.033332890583333205, 0.03333327692686603, 0.033333333333333333, 0.033333832489800749, 0.033332890583333205, 0.03333327692686603, 0.033333333333333333, 0.033333333333333333, 0.033333832489800749, 0.033332890583333205, 0.03333327692686603, 0.033332834193504184, 0.033333776064814934, 0.033332890601851725, 0.033333276917606923, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333333333333333, 0.033333832480541337, 0.033332890601851725, 0.033333276917606923, 0.033332834202763284)
    val params = MannWhitneyParams(mu = 0.0, confidenceLevel = 0.98, controlData = control, experimentData = experiment)
    val mw = new MannWhitney
    val result = mw.eval(params)
    assertEquals(-1.4808028936386108E-5, result.confidenceInterval.head, E)
    assertEquals(1.808255910873413E-5, result.confidenceInterval.last, E)
    assertEquals(1.808255910873413E-5, result.estimate, E)
  }

  test("tie out with R version"){
    val params =
      MannWhitneyParams(
        mu = 0.0,
        confidenceLevel = 0.95,
        controlData =
          Array(1.5, 6.0, 5.0, 2.5, 2.5, 2.0, 2.0, 3.5, 3.0, 3.0, 3.0, 2.0, 3.0, 8.0, 4.0, 2.5, 3.0, 2.5, 2.5, 2.0, 2.5, 2.0, 2.0, 2.5, 3.5, 3.0, 1.5, 5.0, 2.5, 5.5, 2.0, 2.5, 3.5, 2.0, 2.5, 4.0, 2.0, 2.0, 2.0, 2.0, 5.5, 4.5, 4.0, 3.0, 3.0, 3.5, 2.5, 3.0, 2.5, 4.0, 6.0, 2.0, 5.0, 6.0, 3.5, 3.0, 54.5, 3.0, 5.0, 6.0, 3.5, 4.5, 2.5, 2.0, 6.0, 5.0, 2.5, 3.5, 2.0, 3.0, 2.5, 3.5, 3.5, 2.5, 3.0, 4.5, 3.0, 15.5, 5.0, 2.5, 3.0, 4.0, 3.5, 4.0, 4.0, 2.0, 4.5, 2.5, 4.0, 3.0),
        experimentData =
          Array(2.5, 2.5, 2.0, 2.5, 3.5, 2.0, 3.5, 1.5, 3.0, 3.0, 2.5, 3.5, 2.0, 2.5, 2.0, 2.0, 5.0, 3.0, 2.0, 1.5, 2.0, 4.0, 3.0, 2.5, 3.0, 2.0, 2.0, 2.0, 2.5, 3.5, 1.5, 1.5, 3.5, 2.0, 2.5, 2.5, 3.0, 3.5, 2.5, 6.5, 2.5, 4.0, 2.5, 3.0, 2.5, 6.5, 2.5, 3.0, 1.5, 2.0, 2.5, 3.0, 7.5, 1.5, 2.0, 4.0, 2.5, 2.0, 2.5, 3.5, 4.0, 2.5, 3.0, 2.5, 2.0, 3.5, 3.0, 16.5, 3.0, 3.0, 7.0, 4.5, 5.0, 2.0, 3.5, 6.0, 1.5, 3.0, 2.5, 4.0, 3.0, 1.5, 5.0, 3.0, 2.5, 5.5, 3.0, 1.5, 2.5, 6.0)
      )

    val rCiLow = -0.500002521696696
    val rCiHigh = -3.486287505871302E-5
    val rEst = -0.4999393907180323

    println(s"R ci low $rCiLow")
    println(s"R ci high $rCiHigh")
    println(s"R est $rEst")

    val mw = new MannWhitney
    val result = mw.eval(params)

    println("ci low " + result.confidenceInterval.head)
    println("ci high " + result.confidenceInterval.last)
    println("est " + result.estimate)

    assertEquals(rCiLow, result.confidenceInterval.head, E)
    assertEquals(rCiHigh, result.confidenceInterval.last, E)
    //assertEquals(rEst, result.estimate, E)
  }

  test("tie out with R version again"){
    val params =
      MannWhitneyParams(
        mu = 0.0,
        confidenceLevel = 0.98,
        controlData =
          Array(1.5, 1.5, 1.0, 2.0, 1.5, 1.5, 1.5, 2.0, 1.0, 1.0, 2.0, 1.5, 1.5, 1.0, 1.5, 1.5, 1.5, 1.5, 1.5, 2.0, 1.0, 1.5, 3.0, 2.0, 1.0, 1.5, 1.5, 1.5, 2.0, 1.5, 1.0, 1.0, 1.5, 2.5, 2.0, 0.0, 1.0, 2.0, 2.0, 1.5, 3.0, 2.0, 1.0, 2.5, 0.5, 1.5, 0.5, 2.5, 2.0, 1.5, 1.5, 2.0, 1.0, 4.5, 2.5, 0.5, 2.5, 1.5, 1.5, 1.0, 2.0, 1.0, 2.5, 1.5, 2.0, 1.5, 3.0, 1.5, 1.5, 1.5, 1.5, 2.0, 1.0, 2.5, 1.0, 1.5, 2.5, 1.5, 2.5, 2.0, 1.5, 1.5, 1.5, 2.5, 1.0, 7.5, 1.5, 3.0, 5.5, 1.0, 1.5, 2.0, 1.0, 1.5, 2.5, 2.5, 1.0, 1.0, 2.5, 1.5, 1.5, 3.0, 4.0, 1.0, 1.5, 2.0, 1.5, 1.5, 1.5, 2.5, 1.5, 3.5, 2.5, 1.5, 2.0, 1.0, 4.0, 1.5, 1.0, 1.5, 2.5, 2.5, 2.0, 2.5, 1.5, 1.5, 2.0, 1.0, 1.5, 2.0, 1.5, 1.0, 2.5, 1.5, 1.5, 2.0, 2.0, 1.0, 1.5, 2.5, 0.5, 2.0, 2.5, 2.0, 1.0, 2.0, 0.5, 1.5, 1.0, 2.5, 1.0, 1.5, 1.0, 7.0, 1.0, 3.5, 1.5, 2.0, 1.5, 1.5, 2.0, 3.0, 1.5, 1.5, 2.0, 1.5, 2.0, 1.5, 4.0, 2.0, 1.5, 1.5, 1.5, 1.5, 1.5, 0.5, 2.0, 1.0, 1.5, 0.5),
        experimentData =
          Array(1.5, 2.0, 5.0, 1.5, 1.5, 8.5, 1.0, 1.0, 2.0, 1.0, 1.5, 0.5, 2.0, 1.5, 2.0, 1.5, 1.0, 2.5, 1.5, 1.5, 2.0, 1.5, 1.5, 1.5, 2.0, 2.0, 1.0, 5.5, 1.5, 2.0, 1.5, 1.5, 1.0, 2.5, 1.0, 2.0, 1.5, 1.5, 2.0, 2.0, 1.5, 1.5, 1.0, 1.0, 2.0, 0.5, 1.5, 0.5, 3.5, 1.5, 3.0, 19.0, 0.5, 1.5, 0.5, 1.5, 2.0, 1.5, 1.5, 1.5, 1.5, 2.0, 1.5, 2.0, 2.0, 1.5, 1.0, 1.5, 1.0, 2.0, 1.0, 2.0, 1.5, 1.5, 3.0, 2.0, 1.5, 1.5, 0.5, 2.0, 1.5, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.5, 1.0, 1.0, 2.0, 1.5, 1.5, 1.5, 0.5, 1.5, 1.5, 0.5, 1.0, 1.5, 1.5, 1.5, 1.0, 2.0, 2.0, 2.0, 1.5, 1.0, 1.5, 1.0, 1.0, 1.5, 3.5, 2.0, 1.5, 1.0, 2.0, 1.5, 5.5, 0.5, 2.0, 3.5, 1.5, 1.0, 2.0, 0.5, 2.5, 1.0, 1.5, 0.5, 2.0, 2.0, 1.0, 0.5, 1.5, 1.0, 1.5, 0.5, 0.5, 1.0, 1.5, 1.0, 1.5, 0.5, 1.5, 1.0, 1.0, 0.5, 1.0, 0.5, 4.0, 1.0, 1.5, 2.0, 5.5, 1.5, 0.5, 2.0, 1.0, 1.5, 1.0, 1.5, 1.5, 1.0, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 2.0, 0.5, 1.5, 1.0, 2.0, 1.0, 1.0, 0.5, 1.0)
      )

    val rCiLow = -0.4999173250549087
    val rCiHigh = -6.912685789769486E-6
    val rEst = -3.45044082729315E-5

    println(s"R ci low $rCiLow")
    println(s"R ci high $rCiHigh")
    println(s"R est $rEst")

    val mw = new MannWhitney
    val result = mw.eval(params)

    println("ci low " + result.confidenceInterval.head)
    println("ci high " + result.confidenceInterval.last)
    println("est " + result.estimate)

    assertEquals(rCiLow, result.confidenceInterval.head, E)
    assertEquals(rCiHigh, result.confidenceInterval.last, E)
    //assertEquals(rEst, result.estimate, E)
  }

  test("tie out intermediate variables"){
    val experimentData = Array(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6666666666666572, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.7037037037036811, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.5625000000000142, 0.0, 0.0, 0.0, 0.0, 3.3333333333333428, 0.0, 1.7543859649122737, 0.0, 1.8518518518518476, 0.0, 0.0, 1.8518518518518476, 0.0, 0.0, 1.5151515151515156, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.7857142857142776, 1.3333333333333286, 0.0, 3.1250000000000142, 1.9607843137255117, 1.4492753623188293, 2.4390243902438868, 1.6393442622950687, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6129032258064484, 1.9607843137255117, 1.5873015873015817, 0.0, 0.0, 2.8169014084507182, 0.0, 0.0, 3.0303030303030454, 0.0, 0.0, 3.3898305084745743, 0.0, 0.0, 1.234567901234584, 0.0, 0.0, 0.0, 0.0, 1.7241379310344769, 0.0, 0.0, 0.0, 0.0, 1.6949152542372872, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.470588235294116, 0.0, 0.0, 1.3698630136986196, 3.225806451612911, 1.7543859649122879, 3.4482758620689538, 0.0, 3.3333333333333428, 0.0, 0.0, 0.0, 1.818181818181813, 0.0, 0.0, 1.4285714285714448, 0.0, 0.0, 1.8867924528301927, 2.0000000000000284, 0.0, 0.0, 0.0, 2.985074626865682, 0.0, 0.0, 1.6666666666666714, 0.0, 0.0, 1.5625, 1.9230769230769198, 0.0, 1.8518518518518619, 0.0, 2.7027027027027088, 0.0, 0.0, 0.0, 1.3513513513513544, 0.0, 1.818181818181813, 0.0, 1.6666666666666572, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.818181818181813, 0.0, 1.4285714285714164, 0.0, 0.0, 4.1095890410959015, 0.0, 0.0, 0.0, 1.8518518518518619, 0.0, 0.0, 1.8518518518518476, 1.3888888888888857, 0.0, 0.0, 0.0, 0.0, 1.8867924528301785, 1.4285714285714164, 0.0, 0.0, 1.5625, 1.8867924528301927, 0.0, 0.0, 0.0, 0.0, 2.040816326530603, 1.818181818181813, 0.0, 0.0, 1.6393442622950687, 0.0, 1.7241379310344769, 1.5151515151515156, 2.564102564102555, 0.0, 0.0, 0.0, 0.0, 5.5555555555555571, 0.0, 0.0, 4.0816326530612059, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.5714285714285836, 0.0, 2.040816326530603, 3.1746031746031633, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
    val controlData = Array(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.5625000000000142, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3888888888888857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.5384615384615614, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4925373134328339, 0.0, 0.0, 0.0, 1.6949152542373014, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.470588235294116, 0.0, 0.0, 0.0, 0.0, 1.7543859649122879, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.8518518518518619, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6393442622950687, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.7241379310344769, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.5873015873015817, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4925373134328339, 0.0, 0.0, 0.0, 3.1249999999999858, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4925373134328339, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.9850746268656536, 0.0, 2.5000000000000284, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.7857142857142776, 0.0, 0.0, 0.0)

    val params =
      MannWhitneyParams(
        mu = 0.0,
        confidenceLevel = 0.95,
        controlData = controlData,
        experimentData = experimentData
      )

    val rMumin = -3.124999999999986
    val rMumax = 5.555555555555557
    val rZqLower = 1.9599639845400536
    val rZqUpper = -1.9599639845400536
    val rFlower1 = 17.090968923762254
    val rFupper1 = -20.997687930433106
    val rFlower2 = 21.01089689284236
    val rFupper2 = -17.077759961353
    val rCil = 3.521755377702165E-5
    val rCiu = 2.02456461662334E-5
    val rEst = 2.6279243045155653E-5

    println(s"R mumin $rMumin")
    println(s"R mumax $rMumax")
    println(s"R zq.lower $rZqLower")
    println(s"R zq.upper $rZqUpper")
    println(s"R f.lower1 $rFlower1")
    println(s"R f.upper1 $rFupper1")
    println(s"R f.lower2 $rFlower2")
    println(s"R f.upper2 $rFupper2")
    println(s"R ci.lower $rCil")
    println(s"R ci.upper $rCiu")
    println(s"R est $rEst")

    val confidenceLevel1 = params.confidenceLevel
    val x = params.experimentData
    val y = params.controlData
    val xLen = x.length.toDouble
    val yLen = y.length.toDouble

    val alpha: Double = 1.0 - confidenceLevel1
    val muMin: Double = x.min - y.max
    val muMax: Double = x.max - y.min

    val wilcoxonDiffWrapper = (zq: Double) => new UnivariateFunction {
      override def value(input: Double): Double = MannWhitney.wilcoxonDiff(input, zq, x, y)
    }

    val zqLower = new NormalDistribution(0,1).inverseCumulativeProbability(alpha/2) * -1
    val zqUpper = new NormalDistribution(0,1).inverseCumulativeProbability(alpha/2)
    val fLower0 = MannWhitney.wilcoxonDiff(muMin, 0, x, y)
    val fUpper0 = MannWhitney.wilcoxonDiff(muMax, 0, x, y)
    val fLower1 = MannWhitney.wilcoxonDiff(muMin, zqLower, x, y)
    val fUpper1 = MannWhitney.wilcoxonDiff(muMax, zqLower, x, y)
    val fLower2 = MannWhitney.wilcoxonDiff(muMin, zqUpper, x, y)
    val fUpper2 = MannWhitney.wilcoxonDiff(muMax, zqUpper, x, y)
    val ciLower = BrentSolver.solve(muMin, muMax, fLower1, fUpper1, wilcoxonDiffWrapper(zqLower))
    val ciUpper = BrentSolver.solve(muMin, muMax, fLower2, fUpper2, wilcoxonDiffWrapper(zqUpper))
    val est = BrentSolver.solve(muMin, muMax, fLower0, fUpper0, wilcoxonDiffWrapper(0))

    //1e-4, 5
    //diff: -3.5347077141 × 10-5
    //

    println("---------------")
    println("muMin " + muMin)
    println("muMax " + muMax)
    println("zqLower " + zqLower)
    println("zqUpper " + zqUpper)
    println("fLower1 " + fLower1)
    println("fUpper1 " + fUpper1)
    println("fLower2 " + fLower2)
    println("fUpper2 " + fUpper2)
    println("ciLower " + ciLower)
    println("ciUpper " + ciUpper)
    println("est " + est)

    assertEquals(rMumin, muMin, E)
    assertEquals(rMumax, muMax, E)
    assertEquals(rZqLower, zqLower, E)
    assertEquals(rZqUpper, zqUpper, E)
    assertEquals(rFlower1, fLower1, E)
    assertEquals(rFupper1, fUpper1, E)
    assertEquals(rFlower2, fLower2, E)
    assertEquals(rFupper2, fUpper2, E)
    assertEquals(rCil, ciLower, E)
    assertEquals(rCiu, ciUpper, E)
    assertEquals(rEst, est, E)
  }
}
